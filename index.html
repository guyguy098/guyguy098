<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global News Center</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap" rel="stylesheet">

<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
        }

        .header {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
			height: auto;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #4f46e5;
            text-decoration: none;
        }

        .logo-container {
			display: flex;
			align-items: center;
			gap: 1rem;
		}

		.hamburger-btn-main {
			background: rgba(79, 70, 229, 0.8);
			border: none;
			padding: 0.6rem 0.8rem;
			border-radius: 8px;
			color: white;
			font-size: 1.2rem;
			cursor: pointer;
			transition: all 0.3s ease;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.hamburger-btn-main:hover {
			background: rgba(79, 70, 229, 1);
			transform: scale(1.05);
		}

		.controls {
			display: flex;
			align-items: center;
			gap: 2rem;
		}

        .region-filters {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .region-filter {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .region-filter:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .region-filter.active {
            background: rgba(79, 70, 229, 0.6);
            box-shadow: 0 0 20px rgba(79, 70, 229, 0.3);
        }

        .region-filter input {
            display: none;
        }

        .grid-selector {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
        }

        .grid-selector option {
            background: #1a1a2e;
            color: white;
        }

        .bandwidth-monitor {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .bandwidth-value {
            color: #4f46e5;
            font-weight: 600;
        }

        .tool-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tool-select {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: white;
            font-size: 0.9rem;
            min-width: 150px;
        }

        .tool-select option {
            background: #1a1a2e;
            color: white;
        }

        .search-input {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: white;
            font-size: 0.9rem;
            width: 200px;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .main-content {
			padding-top: 120px;
			padding-left: 2rem;
			padding-right: 2rem;
			padding-bottom: 1rem;
			max-width: 1400px;
			margin: 0 auto;
		}

        .grid-container {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: repeat(3, 1fr);
            margin-top: 2rem;
        }

        .video-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            overflow: hidden;
            border: 3px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }

        .video-container:hover {
			border: 3px solid #4f46e5;
			box-shadow: 0 8px 32px rgba(79, 70, 229, 0.4);
		}

        .video-header {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-title {
            font-size: 0.9rem;
            font-weight: 500;
            color: white;
        }

        .country-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-arab { background: rgba(255, 87, 87, 0.2); color: #ff5757; }
        .badge-israel { background: rgba(255, 215, 0, 0.2); color: #ffd700; }
        .badge-usa { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .badge-iran { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .badge-world { background: rgba(168, 85, 247, 0.2); color: #a855f7; }

        .video-element {
            width: 100%;
            height: auto;
            aspect-ratio: 16/9;
            background: #000;
            display: block;
        }

        .video-element.playing {
            pointer-events: auto;
        }

        .play-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(79, 70, 229, 0.8);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .play-overlay:hover {
            background: rgba(79, 70, 229, 1);
            transform: translate(-50%, -50%) scale(1.1);
        }

        .play-overlay i {
            color: white;
            font-size: 1.5rem;
            margin-left: 3px;
        }

        .video-container.playing .play-overlay {
            display: none;
        }

        .video-container.hidden {
            display: none;
        }
		.custom-layout-overlay {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.7);
			z-index: 2000;
			justify-content: center;
			align-items: center;
		}

		.custom-layout-overlay.active {
			display: flex;
		}

		.custom-layout-controls {
			background: #1a1a2e;
			border: 1px solid rgba(255, 255, 255, 0.1);
			border-radius: 12px;
			padding: 1.5rem;
			width: 90%;
			max-width: 800px;
			max-height: 80vh;
			overflow-y: auto;
			position: relative;
		}

		.custom-layout-controls.active {
			display: block;
		}

		.custom-layout-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1.5rem;
			border-bottom: 1px solid rgba(255, 255, 255, 0.1);
			padding-bottom: 1rem;
		}

		.custom-layout-header h3 {
			color: white;
			margin: 0;
			font-size: 1.2rem;
		}

		.custom-layout-close {
			background: none;
			border: none;
			color: white;
			font-size: 1.5rem;
			cursor: pointer;
			padding: 0;
			line-height: 1;
		}
        .stats-bar {
			background: rgba(0, 0, 0, 0.6);
			backdrop-filter: blur(10px);
			padding: 1rem 2rem;
			border-radius: 0;
			display: flex;
			justify-content: space-between;
			align-items: center;
			position: fixed;
			width: 100%;
			left: 0;
			top: 60px;
			z-index: 998;
			border-bottom: 1px solid rgba(255, 255, 255, 0.1);
			box-sizing: border-box;
		}

		.stats-bar-content {
			display: flex;
			justify-content: space-between;
			align-items: center;
			max-width: 1400px;
			margin: 0 auto;
			width: 100%;
		}

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-value {
            font-weight: 600;
            color: #4f46e5;
        }

        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Grid variations */
        .grid-3xY { grid-template-columns: repeat(3, 1fr); }
        .grid-1xY { grid-template-columns: repeat(1, 1fr); }
		.grid-2xY { grid-template-columns: repeat(2, 1fr); }
        .grid-4xY { grid-template-columns: repeat(4, 1fr); }
        .grid-5xY { grid-template-columns: repeat(5, 1fr); }

        /* For medium screens - tablets and narrow desktop */
		@media (max-width: 1200px) {
			.header-content {
				flex-direction: row;
				gap: 0.5rem;
				flex-wrap: wrap;
			}
			
			.logo {
				font-size: 1.4rem;
				flex: 1;
			}
			
			/* Hide text in region filters, show only emojis */
			.region-filter span {
				font-size: 1.3rem;
			}
			
			.region-filters {
				gap: 0.3rem;
			}
			
			.region-filter {
				padding: 0.4rem 0.6rem;
				min-width: auto;
			}
			
			/* Hide secondary header tools */
			.secondary-left {
				display: none;
			}
			
			.secondary-content {
				justify-content: flex-end;
			}
			
			/* Simplify stats bar */
			.stat-item {
				font-size: 0.85rem;
			}
			
			.stat-item:nth-child(2) {
				display: none; /* Hide Traffic Saved */
			}

			.header {
				padding: 0.75rem 1rem;
				height: auto;
			}
			
			.secondary-header {
				padding: 0.75rem 1rem;
				height: auto;
			}
		}

		/* Mobile Sidebar */
		.mobile-sidebar {
			position: fixed;
			left: -350px;
			top: 0;
			width: 320px;
			height: 100vh;
			background: rgba(26, 26, 46, 0.98);
			backdrop-filter: blur(10px);
			z-index: 2000;
			transition: right 0.3s ease;
			overflow-y: auto;
			box-shadow: -5px 0 20px rgba(0, 0, 0, 0.5);
		}

		.mobile-sidebar.active {
			left: 0;
		}

		.mobile-menu-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100vh;
			background: rgba(0, 0, 0, 0.7);
			z-index: 1999;
			display: none;
		}

		.mobile-menu-overlay.active {
			display: block;
		}

		.mobile-sidebar-header {
			background: rgba(0, 0, 0, 0.9);
			padding: 1.5rem;
			display: flex;
			justify-content: space-between;
			align-items: center;
			border-bottom: 1px solid rgba(255, 255, 255, 0.1);
		}

		.mobile-sidebar-header h3 {
			color: #4f46e5;
			font-size: 1.2rem;
			margin: 0;
		}

		.close-sidebar {
			background: none;
			border: none;
			color: white;
			font-size: 1.5rem;
			cursor: pointer;
			padding: 0;
			width: 30px;
			height: 30px;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.mobile-sidebar-content {
			padding: 1.5rem;
		}

		.mobile-tool-section {
			margin-bottom: 2rem;
		}

		.mobile-tool-section h4 {
			color: rgba(255, 255, 255, 0.9);
			font-size: 1rem;
			margin-bottom: 1rem;
			display: flex;
			align-items: center;
			gap: 0.5rem;
		}

		.mobile-tool-select,
		.mobile-search-input {
			width: 100%;
			padding: 0.75rem;
			background: rgba(255, 255, 255, 0.1);
			border: 1px solid rgba(255, 255, 255, 0.2);
			border-radius: 6px;
			color: white;
			font-size: 0.9rem;
			direction: ltr;
			text-align: left;
			unicode-bidi: isolate;
		}

		.mobile-tool-select {
			direction: ltr;
			text-align: left;
		}

		.mobile-tool-select option {
			background: #1a1a2e;
			color: white;
			direction: ltr;
			text-align: left;
		}

		.mobile-search-input::placeholder {
			color: rgba(255, 255, 255, 0.6);
		}

		/* Mobile phones */
		@media (max-width: 768px) {

			/* ── Header ── */
			.header {
				padding: 0.5rem 0.75rem;
				height: auto;
			}

			.header-content {
				flex-direction: row;
				gap: 0.5rem;
				flex-wrap: wrap;
				align-items: center;
			}

			.logo {
				font-size: 1rem;
				flex: 1;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}

			/* Hide grid selector on mobile */
			#gridSelector {
				display: none;
			}

			/* Bigger touch targets for region filters */
			.region-filters {
				gap: 0.25rem;
				flex-wrap: wrap;
				width: 100%;
			}

			.region-filter {
				padding: 0.5rem;
				min-width: 36px;
				min-height: 36px;
				display: flex;
				align-items: center;
				justify-content: center;
				border-radius: 8px;
			}

			.region-filter img {
				width: 22px;
				height: 16px;
			}

			.custom-layout-btn {
				padding: 0.5rem;
				min-width: 36px;
				min-height: 36px;
			}

			/* ── Stats Bar ── */
			.stats-bar {
				padding: 0.4rem 1rem;
			}

			.stats-bar-content {
				gap: 0.5rem;
				flex-wrap: nowrap;
				justify-content: space-between;
				width: 100%;
			}

			.stat-item {
				font-size: 0.75rem;
			}

			.stat-item:nth-child(2) {
				display: none;
			}

			/* ── Main Content ── */
			.main-content {
				padding-top: 110px;
				padding-left: 0.5rem;
				padding-right: 0.5rem;
			}

			/* ── Grid ── */
			.grid-container {
				grid-template-columns: 1fr !important;
				gap: 0.75rem;
				margin-top: 1rem;
			}

			/* ── Video Containers ── */
			.video-container {
				border-radius: 8px;
			}

			.video-header {
				padding: 0.6rem 0.75rem;
			}

			.video-title {
				font-size: 0.85rem;
			}

			.country-badge {
				font-size: 0.7rem;
				padding: 0.2rem 0.5rem;
			}

			/* Bigger play button for touch */
			.play-overlay {
				width: 72px;
				height: 72px;
			}

			.play-overlay i {
				font-size: 2rem;
			}

			/* ── Mobile Sidebar ── */
			.mobile-sidebar {
				width: 85%;
				max-width: 320px;
			}

			.mobile-sidebar-content {
				padding: 1rem;
			}

			/* font-size 1rem prevents iOS auto-zoom on input focus */
			.mobile-tool-select,
			.mobile-search-input {
				font-size: 1rem;
				padding: 0.85rem;
				border-radius: 8px;
			}

			.mobile-tool-section h4 {
				font-size: 0.95rem;
			}

			/* ── Custom Layout Overlay ── */
			.custom-layout-controls {
				width: 95%;
				max-height: 85vh;
				padding: 1rem;
			}

			.channel-picker {
				grid-template-columns: 1fr 1fr;
				gap: 0.5rem;
			}

			.channel-option {
				font-size: 0.8rem;
				padding: 0.4rem;
			}

			.custom-btn {
				padding: 0.6rem 0.8rem;
				font-size: 0.85rem;
			}
		}
		
		/* ── Phone Landscape ── */
		@media (max-width: 900px) and (orientation: landscape) {

			/* Header is too tall in landscape, compress it */
			.header {
				padding: 0.3rem 0.75rem;
			}

			.logo {
				font-size: 0.95rem;
			}

			.region-filter {
				padding: 0.3rem 0.4rem;
				min-height: 30px;
				min-width: 30px;
			}

			.region-filter img {
				width: 20px;
				height: 14px;
			}

			/* Stats bar smaller */
			.stats-bar {
				padding: 0.25rem 1rem;
			}

			.stat-item {
				font-size: 0.72rem;
			}

			/* Less top padding since header is shorter */
			.main-content {
				padding-top: 85px;
			}

			/* 2 columns in landscape instead of 1 */
			.grid-container {
				grid-template-columns: repeat(2, 1fr) !important;
				gap: 0.5rem;
			}

			/* Videos shorter so 2 fit on screen without scrolling */
			.video-element {
				aspect-ratio: 16/9;
				max-height: 35vh;
			}

			/* Bigger sidebar in landscape since screen is wider */
			.mobile-sidebar {
				width: 50%;
				max-width: 400px;
			}

			/* Custom layout overlay */
			.custom-layout-controls {
				max-height: 90vh;
				width: 80%;
			}

			.channel-picker {
				grid-template-columns: repeat(3, 1fr);
			}
		}

		.custom-layout-btn {
			display: flex;
			align-items: center;
			gap: 0.5rem;
			padding: 0.5rem 1rem;
			background: rgba(255, 255, 255, 0.1);
			border: none;
			border-radius: 8px;
			color: white;
			font-size: 0.9rem;
			cursor: pointer;
			transition: all 0.3s ease;
			white-space: nowrap;
			user-select: none;
		}

		.custom-layout-btn:hover {
			background: rgba(255, 255, 255, 0.2);
		}

		.custom-layout-btn.active {
			background: rgba(79, 70, 229, 0.6);
			box-shadow: 0 0 20px rgba(79, 70, 229, 0.3);
		}
		.region-filter img {
			width: 24px;
			height: 18px;
			border-radius: 2px;
			display: block;
			object-fit: contain;
		}
		.region-filter i {
			font-size: 1.2rem;
		}
		.world-icon {
			width: 22px;
			height: 22px;
			object-fit: contain;
		}
		select, option {
			font-family: Arial, 'Noto Color Emoji', sans-serif;
		}
		
		.custom-dropdown {
			position: relative;
			width: 100%;
		}

		.custom-dropdown-selected {
			width: 100%;
			padding: 0.75rem;
			background: #1a1a2e;
			border: 1px solid rgba(255,255,255,0.2);
			border-radius: 6px;
			color: white;
			font-size: 1rem;
			cursor: pointer;
			text-align: left;
			direction: ltr;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.custom-dropdown-list {
			display: none;
			position: absolute;
			top: 100%;
			left: 0;
			right: 0;
			background: #1a1a2e;
			border: 1px solid rgba(255,255,255,0.2);
			border-radius: 6px;
			z-index: 9999;
			max-height: 300px;
			overflow-y: auto;
			direction: ltr;
			text-align: left;
		}

		.custom-dropdown-list.open {
			display: block;
		}

		.custom-dropdown-item {
			padding: 0.6rem 0.75rem;
			color: white;
			cursor: pointer;
			font-size: 0.9rem;
			direction: ltr;
			text-align: left;
			font-family: Arial, 'Noto Color Emoji', 'Apple Color Emoji', 'Segoe UI Emoji', sans-serif;
		}

		.custom-dropdown-item:hover {
			background: rgba(255,255,255,0.1);
		}

		.custom-dropdown-item.disabled {
			color: #aaa;
			font-style: italic;
			cursor: default;
			font-size: 0.8rem;
			padding: 0.3rem 0.75rem;
		}

		.custom-dropdown-item.separator {
			border-top: 1px solid #444;
			padding: 0;
			margin: 2px 0;
		}

    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo-container">
				<button class="hamburger-btn-main" onclick="openMobileMenu()">
					<i class="fas fa-bars"></i>
				</button>
				<a href="#" class="logo">Global News Center</a>
			</div>
            
            <div class="controls">
                <div class="region-filters">
					<label class="region-filter active" id="allFilter" onclick="toggleAll(event)">
						<input type="checkbox" id="allCheckbox" checked>
						<i class="fas fa-check"></i>
					</label>
                    <label class="region-filter active" data-region="arab">
                        <input type="checkbox" id="arabCheckbox" checked>
                        <img src="flags/sa.png" alt="Arab">
                    </label>
                    <label class="region-filter active" data-region="israel">
                        <input type="checkbox" id="israelCheckbox" checked>
                        <img src="flags/il.png" alt="Israel">
                    </label>
                    <label class="region-filter active" data-region="usa">
                        <input type="checkbox" id="usaCheckbox" checked>
                        <img src="flags/us.png" alt="USA">
                    </label>
                    <label class="region-filter active" data-region="iran">
                        <input type="checkbox" id="iranCheckbox" checked>
                        <img src="flags/ir.png" alt="Iran">
                    </label>
                    <label class="region-filter active" data-region="world">
                        <input type="checkbox" id="worldCheckbox" checked>
                        <img src="flags/world.png" alt="World" class="world-icon">
                    </label>
					<button class="custom-layout-btn" onclick="showCustomLayout()">
						<i class="fas fa-pencil"></i>
					</button>
                </div>
                <select class="grid-selector" id="gridSelector">
                    <option value="grid-1xY">1xY</option>
					<option value="grid-2xY">2xY</option>
					<option value="grid-3xY" selected>3xY</option>
					<option value="grid-4xY">4xY</option>
					<option value="grid-5xY">5xY</option>
                </select>
            </div>
        </div>
    </header>

	<div class="custom-layout-overlay" id="customLayoutOverlay" onclick="handleOverlayClick(event)">
		<div class="custom-layout-controls" id="customLayoutControls">
			<div class="custom-layout-header">
				<h3>Select Channels (max 6)</h3>
				<button class="custom-layout-close" onclick="cancelCustomLayout()">×</button>
			</div>
			<div class="channel-picker" id="channelPicker">
				<!-- Channels will be populated by JavaScript -->
			</div>
			<div class="custom-controls">
				<button class="custom-btn" onclick="applyCustomLayout()">Apply Layout</button>
				<button class="custom-btn" onclick="cancelCustomLayout()">Cancel</button>
				<button class="custom-btn" onclick="clearSelection()">Clear All</button>
			</div>
		</div>
	</div>

    <div class="stats-bar">
		<div class="stats-bar-content">
			<div class="stat-item">
				<i class="fas fa-play-circle"></i>
				<span>Active Streams: <span class="stat-value" id="activeStreams">0</span><span style="color: #888;">/</span><span class="stat-value" id="visibleChannels">0</span></span>
			</div>
			<div class="stat-item">
				<i class="fas fa-signal"></i>
				<span>Traffic Saved: <span class="stat-value" id="trafficSaved">High</span></span>
			</div>
			<div class="stat-item">
				<i class="fas fa-chart-line"></i>
				<span>Bandwidth: <span class="stat-value" id="bandwidthUsage">0 Mbps</span></span>
			</div>
		</div>
	</div>

    <main class="main-content">
        <div class="grid-container grid-3xY" id="gridContainer">
            <!-- Arab Channels -->
            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Al Manar - Hezbollah FIXED</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video1" muted preload="none" controls></video>
				<!-- <div class="play-overlay" onclick="playVideo('video1', 'https://e2.manar.live:9000/live/tracks-v1a1/mono.m3u8')"> -->
				<div class="play-overlay" onclick="playVideo('video1', 'https://edge.fastpublish.me/live/tracks-v3a1/mono.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Al Arabiya</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video3" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video3', 'https://live.alarabiya.net/alarabiapublish/alarabiya.smil/playlist.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Alhurra NOT WORKING</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video4" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video4', 'https://mbn-ingest-worldsafe.akamaized.net/hls/live/2038900/MBN_Alhurra_Worldsafe_HLS/master_2596.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Al Jazeera</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video5" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video5', 'https://live-hls-web-aja.getaj.net/AJA/index.m3u8')">
				
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Al Jazeera Mubasher</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video6" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video6', 'https://live-hls-web-ajm.getaj.net/AJM/05.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Al Hadath - Saudi</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video7" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video7', 'https://av.alarabiya.net/alarabiapublish/alhadath.smil/playlist.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Palestine Today</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video8" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video8', 'https://live.paltodaytv.com/paltv/live/playlist.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Jordan TV</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video9" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video9', 'https://jrtv-live.ercdn.net/jordanhd/jordanhd_1080p.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Voice of Lebanon</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video10" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video10', 'https://svs.itworkscdn.net/vdltvlive/vdltv.smil/playlist.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="arab">
                <div class="video-header">
                    <div class="video-title">Syria TV</div>
                    <div class="country-badge badge-arab">Arab</div>
                </div>
                <video class="video-element" id="video11" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video11', 'https://svs.itworkscdn.net/syriatvlive/syriatv.smil/playlist_dvr.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <!-- Israel Channels -->
            <div class="video-container" data-region="israel">
                <div class="video-header">
                    <div class="video-title">ערוץ 11</div>
                    <div class="country-badge badge-israel">Israel</div>
                </div>
                <video class="video-element" id="video12" muted preload="none" controls></video>
				<div class="play-overlay" onclick="playVideo('video12', 'https://kancdn.medonecdn.net/livehls/oil/kancdn-live/live/kan11/live.livx/playlist.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="israel">
                <div class="video-header">
                    <div class="video-title">ערוץ 12 FIXED</div>
                    <div class="country-badge badge-israel">Israel</div>
                </div>
                <video class="video-element" id="video13" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video13', 'https://mako-streaming.akamaized.net/stream/hls/live/2033791/k12n12wad/index.m3u8?b-in-range=0-1800&hdnea=st%3D1772230974%7Eexp%3D1772231874%7Eacl%3D%2F*%7Ehmac%3D273ee965be2fd8f099d06b2bcf45c3b8beb89659a8209fc2038c0634775c08ce&_uid=W28081e5d5f974edb55d919af4f40a50b0bd&dxseg=25SSfD0q%2CMLT0tmGC%2ClVVh9etP%2CmWPE8VTE%2CmqZmzXw7%2CpCTwtlP9%2Cy79VtRne%2CzDDDMl3T%2Cu0UR9fsv%2C40vtNLUs%2CBGue8q07%2CFZOFrmNp%2Cvbk5sJ97%2CC5B5Rnl9&dxu=bee7081a-40a1-4a11-a996-7f51dcef8f04&user_id=fa6990ab321fd2f97ab41832005638ea&cust_params=interests%3D%26smu%3Daf5821f0-8f69-4bf3-8028-74678801be5c&ppid=af5821f0-8f69-4bf3-8028-74678801be5c')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="israel">
                <div class="video-header">
                    <div class="video-title">ערוץ 13 FIXED</div>
                    <div class="country-badge badge-israel">Israel</div>
                </div>
                <video class="video-element" id="video14" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video14', 'https://d18b0e6mopany4.cloudfront.net/out/v1/1a7c55961dec4c72b51d79e5d9216cff/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="israel">
                <div class="video-header">
                    <div class="video-title">ערוץ 14</div>
                    <div class="country-badge badge-israel">Israel</div>
                </div>
                <video class="video-element" id="video15" muted preload="none" controls></video>
                <!-- <div class="play-overlay" onclick="playVideo('video15', 'https://ch14-channel14-content.akamaized.net/hls/live/2104807/CH14_CHANNEL14/2/streamPlaylist.m3u8')"> -->
				<div class="play-overlay" onclick="playVideo('video15', 'https://r.il.cdn-redge.media/livehls/oil/ch14/live/ch14/live.livx/playlist.m3u8')">

					<i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>	
				
            <div class="video-container" data-region="israel">
                <div class="video-header">
                    <div class="video-title">i24News FIXED</div>
                    <div class="country-badge badge-israel">Israel</div>
                </div>
                <video class="video-element" id="video35" muted preload="none" controls></video>
                <!-- <div class="play-overlay" onclick="playVideo('video35', 'https://bcovlive-a.akamaihd.net/6e3dd61ac4c34d6f8fb9698b565b9f50/eu-central-1/5377161796001/playlist-all_dvr.m3u8')"> -->
				<div class="play-overlay" onclick="playVideo('video35', 'https://fastly.live.brightcove.com/6386790215112/eu-central-1/5377161796001/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJob3N0IjoiZXJmajYzLmVncmVzcy53YzQ3bTEiLCJhY2NvdW50X2lkIjoiNTM3NzE2MTc5NjAwMSIsImVobiI6ImZhc3RseS5saXZlLmJyaWdodGNvdmUuY29tIiwiaXNzIjoiYmxpdmUtcGxheWJhY2stc291cmNlLWFwaSIsInN1YiI6InBhdGhtYXB0b2tlbiIsImF1ZCI6WyI1Mzc3MTYxNzk2MDAxIl0sImp0aSI6IjYzODY3OTAyMTUxMTIifQ.8ZawImK7DfcrrXeAT2OVZ62qQJrJiBaoc7Y1DNNq1bg/playlist-hls.m3u8?__nn__=5476555825001&hdnea=st=1767895200~exp=1767898800~acl=/6386790215112/eu-central-1/5377161796001/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJob3N0IjoiZXJmajYzLmVncmVzcy53YzQ3bTEiLCJhY2NvdW50X2lkIjoiNTM3NzE2MTc5NjAwMSIsImVobiI6ImZhc3RseS5saXZlLmJyaWdodGNvdmUuY29tIiwiaXNzIjoiYmxpdmUtcGxheWJhY2stc291cmNlLWFwaSIsInN1YiI6InBhdGhtYXB0b2tlbiIsImF1ZCI6WyI1Mzc3MTYxNzk2MDAxIl0sImp0aSI6IjYzODY3OTAyMTUxMTIifQ.8ZawImK7DfcrrXeAT2OVZ62qQJrJiBaoc7Y1DNNq1bg/*~hmac=59be9c55159d8b6167ec5d5a7528df6b7bf144a4d8fe71dd486a93e5032f20a2')">

                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <!-- USA Channels -->
            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">CNN FIXED</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video16" muted preload="none" controls></video>
                <!-- <div class="play-overlay" onclick="playVideo('video16', 'https://cnn-cnninternational-1-eu.rakuten.wurl.tv/playlist.m3u8')"> -->
				<div class="play-overlay" onclick="playVideo('video16', 'https://d3bp6dwmpbdajl.cloudfront.net/v1/master/3722c60a815c199d9c0ef36c5b73da68a62b09d1/cc-ury0meh5m4nzm/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">CNN 2</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video17" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video17', 'https://turnerlive.warnermediacdn.com/hls/live/586495/cnngo/cnn_slate/VIDEO_4_1064000.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">FOX News</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video18" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video18', 'https://247preview.foxnews.com/hls/live/2020027/fncv3preview/primary.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">LiveNOW from FOX NOT WORKING</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video19" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video19', 'https://lnc-fox-live-now.tubi.video/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">NBC News FIXED</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video20" muted preload="none" controls></video>
                <!-- <div class="play-overlay" onclick="playVideo('video20', 'https://lnc-nbc-news-now.tubi.video/master.m3u8')"> -->
				<div class="play-overlay" onclick="playVideo('video20', 'https://d4ybyqrhce41r.cloudfront.net/v1/master/3fec3e5cac39a52b2132f9c66c83dae043dc17d4/prod-xumo-linear-nbcu-hlsv3/master.m3u8?ads.channelId=99991247')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">ABC News FIXED</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video21" muted preload="none" controls></video>
                <!-- <div class="play-overlay" onclick="playVideo('video21', 'https://lnc-abc-news.tubi.video/index.m3u8')"> -->
                <div class="play-overlay" onclick="playVideo('video21', 'https://live-manifest.production-public.tubi.io/live/14e4f5f2-9787-4c49-8554-f2ad109764a7/playlist.m3u8')">
					<i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">CBS News</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video22" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video22', 'https://cbsn-us.cbsnstream.cbsnews.com/out/v1/55a8648e8f134e82a470f83d562deeca/master.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="usa">
                <div class="video-header">
                    <div class="video-title">News12 New York NOT WORKING</div>
                    <div class="country-badge badge-usa">USA</div>
                </div>
                <video class="video-element" id="video23" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video23', 'https://lnc-news12.tubi.video/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <!-- Iran Channels -->
            <div class="video-container" data-region="iran">
                <div class="video-header">
                    <div class="video-title">Al Mayadeen NOT WORKING</div>
                    <div class="country-badge badge-iran">Iran</div>
                </div>
                <video class="video-element" id="video24" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video24', 'https://mdnlv.cdn.octivid.com/almdn/smil:mpegts.stream.smil/chunklist_b2000000_t64NDgwcA==.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="iran">
                <div class="video-header">
                    <div class="video-title">Iran-e-Farda TV</div>
                    <div class="country-badge badge-iran">Iran</div>
                </div>
                <video class="video-element" id="video25" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video25', 'https://hls.iranfarda.live/hls/stream.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="iran">
                <div class="video-header">
                    <div class="video-title">Simaye Azadi NOT WORKING</div>
                    <div class="country-badge badge-iran">Iran</div>
                </div>
                <video class="video-element" id="video26" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video26', 'https://simaytv.akamaized.net/hls/live/2043550/simayhls/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="iran">
                <div class="video-header">
                    <div class="video-title">Iran International</div>
                    <div class="country-badge badge-iran">Iran</div>
                </div>
                <video class="video-element" id="video27" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video27', 'https://dev-live.livetvstream.co.uk/LS-63503-4/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="iran">
                <div class="video-header">
                    <div class="video-title">IRINN NOT WORKING</div>
                    <div class="country-badge badge-iran">Iran</div>
                </div>
                <video class="video-element" id="video28" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video28', 'https://live.aionet.ir/hls/irinn/irinn.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="iran">
                <div class="video-header">
                    <div class="video-title">SNN NOT WORKING</div>
                    <div class="country-badge badge-iran">Iran</div>
                </div>
                <video class="video-element" id="video29" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video29', 'https://live2.snn.ir/hls/snn0_low/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="iran">
                <div class="video-header">
                    <div class="video-title">Press TV</div>
                    <div class="country-badge badge-iran">Iran</div>
                </div>
                <video class="video-element" id="video30" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video30', 'https://live.presstv.ir/hls/presstv_5_482/index.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <!-- World Channels -->
            <div class="video-container" data-region="world">
                <div class="video-header">
                    <div class="video-title">BBC World</div>
                    <div class="country-badge badge-world">World</div>
                </div>
                <video class="video-element" id="video31" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video31', 'https://vs-hls-push-ww-live.akamaized.net/x=4/i=urn:bbc:pips:service:bbc_news_channel_hd/t=3840/v=pv14/b=5070016/main.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="world">
                <div class="video-header">
                    <div class="video-title">Sky News UK</div>
                    <div class="country-badge badge-world">World</div>
                </div>
                <video class="video-element" id="video32" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video32', 'https://linear417-gb-hls3-prd-ak.cdn.skycdp.com/100e/Content/HLS_004_1080_30/Live/channel(skynews)/index_1080.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="world">
                <div class="video-header">
                    <div class="video-title">Global News Canada</div>
                    <div class="country-badge badge-world">World</div>
                </div>
                <video class="video-element" id="video33" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video33', 'https://live.corusdigitaldev.com/groupd/live/49a91e7f-1023-430f-8d66-561055f3d0f7/live.isml/master.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>

            <div class="video-container" data-region="world">
                <div class="video-header">
                    <div class="video-title">RT News</div>
                    <div class="country-badge badge-world">World</div>
                </div>
                <video class="video-element" id="video34" muted preload="none" controls></video>
                <div class="play-overlay" onclick="playVideo('video34', 'https://rt-glb.rttv.com/live/rtnews/playlist.m3u8')">
                    <i class="fas fa-play"></i>
                </div>
                <div class="loading-indicator"><div class="spinner"></div></div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        let activeStreams = new Set();
        let loadedStreams = new Map();
        let bandwidthMonitor = {
            startTime: Date.now(),
            totalBytes: 0,
            currentBandwidth: 0
        };

		function adjustStatBarPosition() {
			const header = document.querySelector('.header');
			const statsBar = document.querySelector('.stats-bar');
			const mainContent = document.querySelector('.main-content');
			
			const headerHeight = header.getBoundingClientRect().height;
			statsBar.style.top = headerHeight + 'px';

			// Read stats bar height AFTER setting its top position
			setTimeout(() => {
				const statsBarHeight = statsBar.getBoundingClientRect().height;
				mainContent.style.paddingTop = (headerHeight + statsBarHeight + 10) + 'px';
			}, 10);
		}
		window.addEventListener('resize', () => {
			clearTimeout(window.resizeTimer);
			window.resizeTimer = setTimeout(adjustStatBarPosition, 50);
		});
		
		function toggleAll(event) {
			event.preventDefault();
			const allCheckbox = document.getElementById('allCheckbox');
			const allFilter = document.getElementById('allFilter');
			const isChecked = !allCheckbox.checked;

			allCheckbox.checked = isChecked;
			allFilter.classList.toggle('active', isChecked);

			// Set all region filters to match
			document.querySelectorAll('.region-filter:not(#allFilter)').forEach(filter => {
				filter.classList.toggle('active', isChecked);
				filter.querySelector('input').checked = isChecked;
			});

			// Reset custom layout
			document.querySelector('.custom-layout-btn').classList.remove('active');
			customSelectedChannels.clear();
			document.querySelectorAll('.video-container').forEach(c => c.classList.remove('hidden'));
			updateCustomControls();
			
			filterVideos();
			updateStats();
		}

        // Generate poster image for video containers
        function generatePosterImage(videoId, region) {
            const canvas = document.createElement('canvas');
            canvas.width = 640;
            canvas.height = 360;
            const ctx = canvas.getContext('2d');
            
            // Create solid dark background instead of colored gradient
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, 640, 360);
            
            // Add region indicator
            ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
            ctx.fillRect(0, 320, 640, 40);
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`${region.toUpperCase()} NEWS`, 320, 345);
            
            // Add play icon
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.beginPath();
            ctx.moveTo(290, 160);
            ctx.lineTo(290, 200);
            ctx.lineTo(320, 180);
            ctx.closePath();
            ctx.fill();
            
            return canvas.toDataURL();
        }

		// Generate red X image for unavailable streams
		function generateUnavailableImage() {
			const canvas = document.createElement('canvas');
			canvas.width = 640;
			canvas.height = 360;
			const ctx = canvas.getContext('2d');
			
			// Dark background
			ctx.fillStyle = '#1a1a1a';
			ctx.fillRect(0, 0, 640, 360);
			
			// Red X
			ctx.strokeStyle = '#ff0000';
			ctx.lineWidth = 8;
			ctx.lineCap = 'round';
			
			// Draw X (two diagonal lines)
			ctx.beginPath();
			// Top-left to bottom-right
			ctx.moveTo(200, 120);
			ctx.lineTo(440, 240);
			// Top-right to bottom-left
			ctx.moveTo(440, 120);
			ctx.lineTo(200, 240);
			ctx.stroke();
			
			// "UNAVAILABLE" text
			ctx.fillStyle = '#ff0000';
			ctx.font = 'bold 24px Arial';
			ctx.textAlign = 'center';
			ctx.fillText('STREAM UNAVAILABLE', 320, 290);
			
			return canvas.toDataURL();
		}

        // Initialize the application
		document.addEventListener('DOMContentLoaded', function() {
			initializePosters();
			initializeFilters();
			initializeGridSelector();
			initializeBandwidthMonitoring();
			autoLoadAllVideos();
			updateStats();
			setTimeout(adjustStatBarPosition, 50);
			
			// Double-click to fullscreen
			document.querySelectorAll('video').forEach(video => {
				video.addEventListener('dblclick', function() {
					toggleFullscreen(this);
				});
			});

			// Observe all video containers for performance
			document.querySelectorAll('.video-container').forEach(container => {
				observer.observe(container);
			});

			// Mobile war maps
			document.getElementById('mobileWarMaps').addEventListener('change', function() {
				if (this.value) { window.open(this.value, '_blank'); this.value = ''; }
			});

			// Mobile news sites
			document.getElementById('mobileNewsSites').addEventListener('change', function() {
				if (this.value) { window.open(this.value, '_blank'); this.value = ''; }
			});

			// Mobile search
			document.getElementById('mobileSearchBox').addEventListener('keypress', function(event) {
				if (event.key === 'Enter' && this.value.trim()) {
					window.open(`https://www.google.com/maps/search/${encodeURIComponent(this.value.trim())}`, '_blank');
					this.value = '';
					closeMobileMenu();
				}
			});
		});

        // Initialize poster images for all videos
        function initializePosters() {
            const videoContainers = document.querySelectorAll('.video-container');
            videoContainers.forEach(container => {
                const video = container.querySelector('video');
                const region = container.getAttribute('data-region');
                const posterUrl = generatePosterImage(video.id, region);
                video.poster = posterUrl;
            });
        }

		// Auto-load all videos and pause them to show first frame
		function autoLoadAllVideos() {
			const MAX_CONCURRENT_PREVIEWS = 6; // 6 x 2.5 Mbps = 15 Mbps cap
			let activePreviewCount = 0;
			const queue = [];

			document.querySelectorAll('.video-container').forEach(container => {
				const video = container.querySelector('video');
				const playOverlay = container.querySelector('.play-overlay');
				const urlMatch = playOverlay.getAttribute('onclick').match(/'([^']+)'/g);
				if (urlMatch && urlMatch[1]) {
					queue.push({ videoId: video.id, streamUrl: urlMatch[1].replace(/'/g, '') });
				}
			});

			function loadNext() {
				while (activePreviewCount < MAX_CONCURRENT_PREVIEWS && queue.length > 0) {
					const { videoId, streamUrl } = queue.shift();
					activePreviewCount++;
					loadVideoForPreview(videoId, streamUrl, () => {
						activePreviewCount--;
						loadNext();
					});
				}
			}

			loadNext();
		}

		// Load video just to get first frame, then pause
		function loadVideoForPreview(videoId, streamUrl, onComplete) {
			const video = document.getElementById(videoId);
			const videoContainer = video.closest('.video-container');
			
			// Track preview loading for bandwidth calculation
			activeStreams.add(videoId + '_preview');
			updateStats();
			
			if (Hls.isSupported()) {
				const hls = new Hls({
					enableWorker: false,
					lowLatencyMode: false,
					backBufferLength: 1,
					maxBufferLength: 3
				});
				
				hls.loadSource(streamUrl);
				hls.attachMedia(video);
				
				// Wait for first frame to be ready
				video.addEventListener('loadeddata', function() {
					video.play().then(() => {
						// Wait a moment for frame to display
						setTimeout(() => {
							// Capture the current frame as canvas image
							const canvas = document.createElement('canvas');
							canvas.width = video.videoWidth || 640;
							canvas.height = video.videoHeight || 360;
							const ctx = canvas.getContext('2d');
							
							try {
								// Draw current video frame to canvas
								ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
								
								// Convert to poster image
								const posterUrl = canvas.toDataURL('image/jpeg', 0.8);
								
								// Pause and destroy HLS
								video.pause();
								hls.destroy();
								
								// Set the captured frame as poster
								video.poster = posterUrl;
								video.src = '';
								video.load();
								
							} catch (error) {
								console.log('Could not capture frame for', videoId, error);
								// Fallback: just pause and destroy
								video.pause();
								hls.destroy();
							}
							
							// Remove from active streams
							activeStreams.delete(videoId + '_preview');
							updateStats();
							if (onComplete) onComplete();
							
						}, 1000); // Wait 1 second for stable frame
					}).catch(() => {
						// Set red X image as poster
						const unavailableImage = generateUnavailableImage();
						video.poster = unavailableImage;
						video.src = '';
						video.load();
						
						// Remove controls and play overlay
						video.removeAttribute('controls');
						const playOverlay = videoContainer.querySelector('.play-overlay');
						if (playOverlay) {
							playOverlay.style.display = 'none';
						}
						
						// Mark container as unavailable
						videoContainer.classList.add('stream-unavailable');
						
						hls.destroy();
						activeStreams.delete(videoId + '_preview');
						updateStats();
						if (onComplete) onComplete();
});
				}, { once: true });
				
				hls.on(Hls.Events.ERROR, function(event, data) {
					console.log('Preview load failed for', videoId);
					
					// Set red X image as poster
					const unavailableImage = generateUnavailableImage();
					video.poster = unavailableImage;
					video.src = '';
					video.load();
					
					// Remove controls and play overlay
					video.removeAttribute('controls');
					const playOverlay = videoContainer.querySelector('.play-overlay');
					if (playOverlay) {
						playOverlay.style.display = 'none';
					}
					
					// Mark container as unavailable
					videoContainer.classList.add('stream-unavailable');
					
					hls.destroy();
					activeStreams.delete(videoId + '_preview');
					updateStats();
					if (onComplete) onComplete();
				});
			}
		}

        // Initialize bandwidth monitoring
        function initializeBandwidthMonitoring() {
            setInterval(updateBandwidthUsage, 1000);
        }

        // Update bandwidth usage display
        function updateBandwidthUsage() {
			let totalBps = 0;

			loadedStreams.forEach((hls, videoId) => {
				if (videoId.endsWith('_preview')) return;
				if (!activeStreams.has(videoId)) return;

				if (hls === true) {
					// Native HLS (Safari) — read bitrate from video element
					const video = document.getElementById(videoId);
					if (video && video.webkitVideoDecodedByteCount !== undefined) {
						// Rough estimate from decoded bytes if available
						totalBps += 2_500_000; // fallback: 2.5 Mbps for native
					} else {
						totalBps += 2_500_000; // fallback: 2.5 Mbps
					}
					return;
				}

				if (!hls || !hls.levels) return;

				// Try current level bitrate first
				const level = hls.levels[hls.currentLevel];
				if (level && level.bitrate) {
					totalBps += level.bitrate;
					return;
				}

				// Fallback: if currentLevel not set yet, use lowest available level
				const fallbackLevel = hls.levels.find(l => l.bitrate > 0);
				if (fallbackLevel) {
					totalBps += fallbackLevel.bitrate;
					return;
				}

				// Last resort: use HLS.js bandwidth estimate divided by active stream count
				if (hls.bandwidthEstimate) {
					const realCount = Array.from(activeStreams).filter(id => !id.endsWith('_preview')).length;
					totalBps += hls.bandwidthEstimate / (realCount || 1);
				}
			});

			const totalMbps = totalBps / 1_000_000;
			const bandwidthElement = document.getElementById('bandwidthUsage');

			if (totalMbps > 0) {
				bandwidthElement.textContent = `${totalMbps.toFixed(1)} Mbps`;
				bandwidthElement.style.color = totalMbps >= 15 ? '#ef4444' : '#4f46e5';
			} else {
				bandwidthElement.textContent = '0 Mbps';
				bandwidthElement.style.color = '#22c55e';
			}
		}

        // Initialize region filters
        function initializeFilters() {
            const regionFilters = document.querySelectorAll('.region-filter');
            
            regionFilters.forEach(filter => {
                filter.addEventListener('click', function() {
					const checkbox = this.querySelector('input');
					const isChecked = !checkbox.checked;
					
					checkbox.checked = isChecked;
					this.classList.toggle('active', isChecked);

					document.querySelector('.custom-layout-btn').classList.remove('active');
					customSelectedChannels.clear();
					document.querySelectorAll('.video-container').forEach(c => c.classList.remove('hidden'));
					updateCustomControls();

					// Sync All button — active only if all region filters are checked
					const allChecked = Array.from(document.querySelectorAll('.region-filter:not(#allFilter) input')).every(cb => cb.checked);
					document.getElementById('allCheckbox').checked = allChecked;
					document.getElementById('allFilter').classList.toggle('active', allChecked);

					filterVideos();
					updateStats();
				});
            });
        }

        // Initialize grid selector
        function initializeGridSelector() {
            const gridSelector = document.getElementById('gridSelector');
            gridSelector.addEventListener('change', function() {
                changeGrid(this.value);
            });
            updateGridOptionsForOrientation();
            window.addEventListener('resize', updateGridOptionsForOrientation);
            window.addEventListener('orientationchange', updateGridOptionsForOrientation);
        }

        function updateGridOptionsForOrientation() {
            const selector = document.getElementById('gridSelector');
            
            // Use screen.orientation if available, fallback to dimensions
            let isLandscapeMobile;
            if (screen.orientation) {
                const angle = screen.orientation.angle;
                const type = screen.orientation.type;
                const isLandscape = type.includes('landscape') || angle === 90 || angle === 270;
                const isSmallScreen = Math.min(screen.width, screen.height) <= 900;
                isLandscapeMobile = isLandscape && isSmallScreen;
            } else {
                isLandscapeMobile = window.innerHeight < window.innerWidth && window.innerWidth <= 900;
            }

            if (isLandscapeMobile) {
                selector.innerHTML = `
                    <option value="grid-2xY">2xY</option>
                    <option value="grid-3xY">3xY</option>
                `;
                changeGrid('grid-2xY');
            } else {
                selector.innerHTML = `
                    <option value="grid-1xY">1xY</option>
                    <option value="grid-2xY">2xY</option>
                    <option value="grid-3xY" selected>3xY</option>
                    <option value="grid-4xY">4xY</option>
                    <option value="grid-5xY">5xY</option>
                `;
                changeGrid('grid-3xY');
            }
        }

		// Show custom layout picker
		function showCustomLayout() {
			initializeCustomLayout();
			document.getElementById('customLayoutOverlay').classList.add('active');
			document.querySelector('.custom-layout-btn').classList.add('active');
		}

        // Play video function - only loads when clicked
		function playVideo(videoId, streamUrl) {
			const videoContainer = document.querySelector(`#${videoId}`).closest('.video-container');
			const video = document.getElementById(videoId);
			const loadingIndicator = videoContainer.querySelector('.loading-indicator');

			// Show loading indicator
			loadingIndicator.style.display = 'block';

			// Check if stream is already loaded
			if (loadedStreams.has(videoId)) {
				// Still enforce limit even for previously loaded streams
				const realActiveStreams = Array.from(activeStreams).filter(id => !id.endsWith('_preview'));
				if (realActiveStreams.length >= 6 && !activeStreams.has(videoId)) {
					loadingIndicator.style.display = 'none';
					showErrorMessage(videoContainer, 'Bandwidth limit reached (6 streams / 15 Mbps). Stop a stream first.');
					return;
				}
				video.play();
				video.classList.add('playing');
				videoContainer.classList.add('playing');
				activeStreams.add(videoId);
				loadingIndicator.style.display = 'none';
				updateStats();
				return;
			}

			// Enforce limit for new streams
			const realActiveStreams = Array.from(activeStreams).filter(id => !id.endsWith('_preview'));
			if (realActiveStreams.length >= 6 && !activeStreams.has(videoId)) {
				loadingIndicator.style.display = 'none';
				showErrorMessage(videoContainer, 'Bandwidth limit reached (6 streams / 15 Mbps). Stop a stream first.');
				return;
			}

			// Check if preview is loaded, destroy it and load properly
			if (loadedStreams.has(videoId + '_preview')) {
				const previewHls = loadedStreams.get(videoId + '_preview');
				if (previewHls && previewHls.destroy) {
					previewHls.destroy();
				}
				loadedStreams.delete(videoId + '_preview');
			}

			// Load stream
			if (Hls.isSupported()) {
				const hls = new Hls({
					enableWorker: false,
					lowLatencyMode: true,
					backBufferLength: 30
				});
				
				hls.loadSource(streamUrl);
				hls.attachMedia(video);
				
				hls.on(Hls.Events.MANIFEST_PARSED, function() {
					loadingIndicator.style.display = 'none';
					video.classList.add('playing');
					videoContainer.classList.add('playing');
					activeStreams.add(videoId);
					loadedStreams.set(videoId, hls);
					
					// ADD THESE LINES - Track play/pause events for bandwidth
					video.addEventListener('play', function() {
						const realActiveStreams = Array.from(activeStreams).filter(id => !id.endsWith('_preview'));
						if (realActiveStreams.length >= 6 && !activeStreams.has(videoId)) {
							video.pause();
							showErrorMessage(videoContainer, 'Bandwidth limit reached (6 streams / 15 Mbps). Stop a stream first.');
							return;
						}
						activeStreams.add(videoId);
						updateStats();
					});
					
					video.addEventListener('pause', function() {
						activeStreams.delete(videoId);
						updateStats();
					});
					
					video.play();
					updateStats();
				});
				
				hls.on(Hls.Events.ERROR, function(event, data) {
					console.error('HLS Error:', data);
					loadingIndicator.style.display = 'none';
					showErrorMessage(videoContainer, 'Stream unavailable');
				});
				
			} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
				video.src = streamUrl;
				video.addEventListener('canplay', function() {
					loadingIndicator.style.display = 'none';
					video.classList.add('playing');
					videoContainer.classList.add('playing');
					activeStreams.add(videoId);
					loadedStreams.set(videoId, true);
					
					// ADD THESE LINES - Track play/pause events for bandwidth
					video.addEventListener('play', function() {
						const realActiveStreams = Array.from(activeStreams).filter(id => !id.endsWith('_preview'));
						if (realActiveStreams.length >= 6 && !activeStreams.has(videoId)) {
							video.pause();
							showErrorMessage(videoContainer, 'Bandwidth limit reached (6 streams / 15 Mbps). Stop a stream first.');
							return;
						}
						activeStreams.add(videoId);
						updateStats();
					});
					
					video.addEventListener('pause', function() {
						activeStreams.delete(videoId);
						updateStats();
					});
					
					video.play();
					updateStats();
				});
			}
		}

        // Stop video and free resources
        function stopVideo(videoId) {
            const video = document.getElementById(videoId);
            const videoContainer = video.closest('.video-container');
            
            video.pause();
            video.currentTime = 0;
            
            // Destroy HLS instance if exists
            if (loadedStreams.has(videoId) && loadedStreams.get(videoId) !== true) {
                const hls = loadedStreams.get(videoId);
                hls.destroy();
            }
            
            loadedStreams.delete(videoId);
            activeStreams.delete(videoId);
            videoContainer.classList.remove('playing');
            
            updateStats();
        }

        // Show error message
        function showErrorMessage(container, message) {
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(239, 68, 68, 0.9);
                color: white;
                padding: 1rem;
                border-radius: 8px;
                font-size: 0.9rem;
                z-index: 20;
            `;
            errorDiv.textContent = message;
            container.appendChild(errorDiv);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 3000);
        }

        // Filter videos based on region selection
        function filterVideos() {
            const arabChecked = document.getElementById('arabCheckbox').checked;
            const israelChecked = document.getElementById('israelCheckbox').checked;
            const usaChecked = document.getElementById('usaCheckbox').checked;
            const iranChecked = document.getElementById('iranCheckbox').checked;
            const worldChecked = document.getElementById('worldCheckbox').checked;
            
            const videoContainers = document.querySelectorAll('.video-container');
            
            videoContainers.forEach(container => {
                const region = container.getAttribute('data-region');
                let shouldShow = false;
                
                switch(region) {
                    case 'arab':
                        shouldShow = arabChecked;
                        break;
                    case 'israel':
                        shouldShow = israelChecked;
                        break;
                    case 'usa':
                        shouldShow = usaChecked;
                        break;
                    case 'iran':
                        shouldShow = iranChecked;
                        break;
                    case 'world':
                        shouldShow = worldChecked;
                        break;
                }
                
                if (shouldShow) {
                    container.classList.remove('hidden');
                } else {
                    container.classList.add('hidden');
                    
                    // Stop video if it's playing and region is hidden
                    const video = container.querySelector('video');
                    if (video && activeStreams.has(video.id)) {
                        stopVideo(video.id);
                    }
                }
            });
        }

        // Change grid layout
        function changeGrid(gridClass) {
            const gridContainer = document.getElementById('gridContainer');
            
            // Remove all grid classes
			gridContainer.classList.remove('grid-1xY', 'grid-2xY', 'grid-3xY', 'grid-4xY', 'grid-5xY');
            
            // Add new grid class
            gridContainer.classList.add(gridClass);
        }

        // Update statistics
        function updateStats() {
            const visibleContainers = document.querySelectorAll('.video-container:not(.hidden)');
            const activeStreamCount = activeStreams.size;
            const visibleChannelCount = visibleContainers.length;
            
            document.getElementById('activeStreams').textContent = activeStreamCount;
			document.getElementById('visibleChannels').textContent = visibleChannelCount;
            
            // Calculate traffic savings
            const totalChannels = document.querySelectorAll('.video-container').length;
            const inactiveChannels = totalChannels - activeStreamCount;
            const trafficSavedPercent = Math.round((inactiveChannels / totalChannels) * 100);
            
            document.getElementById('trafficSaved').textContent = `${trafficSavedPercent}%`;
            
            // Update bandwidth monitoring
            updateBandwidthUsage();
        }

		// Custom layout functionality
		let customSelectedChannels = new Set();

		// Initialize custom layout controls
		function initializeCustomLayout() {
			const channelPicker = document.getElementById('channelPicker');
			const videoContainers = document.querySelectorAll('.video-container');
			
			channelPicker.innerHTML = '';
			
			videoContainers.forEach(container => {
				const video = container.querySelector('video');
				const title = container.querySelector('.video-title').textContent;
				const region = container.getAttribute('data-region');
				const badge = container.querySelector('.country-badge');
				
				const isSelected = customSelectedChannels.has(video.id);
				const channelOption = document.createElement('div');
				channelOption.className = 'channel-option' + (isSelected ? ' selected' : '');
				channelOption.innerHTML = `
					<input type="checkbox" id="custom_${video.id}" value="${video.id}" ${isSelected ? 'checked' : ''}>
					<span class="country-badge ${badge.className.split(' ')[1]}">${region.toUpperCase()}</span>
					<span>${title}</span>
				`;
				
				channelOption.addEventListener('click', function(e) {
					if (e.target.type !== 'checkbox') {
						const checkbox = this.querySelector('input');
						checkbox.checked = !checkbox.checked;
					}
					toggleChannelSelection(video.id, this);
				});
				
				channelPicker.appendChild(channelOption);
			});
		}

		// Toggle channel selection
		function toggleChannelSelection(videoId, optionElement) {
			const checkbox = optionElement.querySelector('input');
			
			if (checkbox.checked) {
				if (customSelectedChannels.size < 6) {
					customSelectedChannels.add(videoId);
					optionElement.classList.add('selected');
				} else {
					checkbox.checked = false;
					alert('Maximum 6 channels allowed');
				}
			} else {
				customSelectedChannels.delete(videoId);
				optionElement.classList.remove('selected');
			}
			
			updateCustomControls();
		}

		// Update custom controls state
		function updateCustomControls() {
			const applyBtn = document.querySelector('.custom-controls .custom-btn');
			applyBtn.textContent = `Apply Layout (${customSelectedChannels.size}/6)`;
			applyBtn.disabled = customSelectedChannels.size === 0;
		}

		// Apply custom layout
		function applyCustomLayout() {
			if (customSelectedChannels.size === 0) return;
			
			const allContainers = document.querySelectorAll('.video-container');
			
			// Hide all containers first
			allContainers.forEach(container => {
				container.classList.add('hidden');
			});
			
			// Show only selected containers
			customSelectedChannels.forEach(videoId => {
				const container = document.getElementById(videoId).closest('.video-container');
				container.classList.remove('hidden');
			});
			
			// Set appropriate grid based on selection count
			const gridContainer = document.getElementById('gridContainer');
			gridContainer.classList.remove('grid-1xY', 'grid-2xY', 'grid-3xY', 'grid-4xY', 'grid-5xY');
			
			if (customSelectedChannels.size === 1) {
				gridContainer.classList.add('grid-1xY');
			} else if (customSelectedChannels.size <= 4) {
				gridContainer.classList.add('grid-2xY');
			} else {
				gridContainer.classList.add('grid-3xY');
			}
			
			document.getElementById('customLayoutOverlay').classList.remove('active');
			// Keep button purple — custom layout is still active
			// Deactivate all region filter buttons
			document.querySelectorAll('.region-filter').forEach(filter => {
				filter.classList.remove('active');
				filter.querySelector('input').checked = false;
			});
			document.getElementById('allCheckbox').checked = false;
			document.getElementById('allFilter').classList.remove('active');
			
			updateStats();
		}

		// Cancel custom layout
		function cancelCustomLayout() {
			document.getElementById('customLayoutOverlay').classList.remove('active');
			// Only deactivate button if user hasn't applied a custom layout
			if (customSelectedChannels.size === 0) {
				document.querySelector('.custom-layout-btn').classList.remove('active');
			}
		}

		// Clear all selections
		function clearSelection() {
			customSelectedChannels.clear();
			const options = document.querySelectorAll('.channel-option');
			options.forEach(option => {
				option.classList.remove('selected');
				option.querySelector('input').checked = false;
			});
			updateCustomControls();
		}

		function handleOverlayClick(event) {
			if (event.target === document.getElementById('customLayoutOverlay')) {
				cancelCustomLayout();
			}
		}

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // Press 'S' to stop all videos
            if (event.key.toLowerCase() === 's' && !event.target.matches('input')) {
                event.preventDefault();
                stopAllVideos();
            }
            
            // Press 'F' to toggle fullscreen on focused video
            if (event.key.toLowerCase() === 'f' && !event.target.matches('input')) {
                event.preventDefault();
                const focusedVideo = document.querySelector('video:focus');
                if (focusedVideo) {
                    toggleFullscreen(focusedVideo);
                }
            }
        });

        // Stop all active videos
        function stopAllVideos() {
            const activeVideoIds = Array.from(activeStreams);
            activeVideoIds.forEach(videoId => {
                stopVideo(videoId);
            });
        }

        // Toggle fullscreen for video
        function toggleFullscreen(video) {
            if (!document.fullscreenElement) {
                video.requestFullscreen().catch(err => {
                    console.error('Error attempting to enable fullscreen:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }



        // Intersection Observer for performance optimization - DISABLED auto-play
		const observer = new IntersectionObserver((entries) => {
			entries.forEach(entry => {
				const video = entry.target.querySelector('video');
				if (!entry.isIntersecting && video && activeStreams.has(video.id)) {
					// Only pause videos that are out of view, don't auto-play
					video.pause();
				}
				// Removed auto-play when scrolling back into view
			});
		}, {
			threshold: 0.1
		});


		
		// Mobile menu functions
		function openMobileMenu() {
			document.getElementById('mobileSidebar').classList.add('active');
			document.getElementById('mobileMenuOverlay').classList.add('active');
			document.body.style.overflow = 'hidden';
		}

		function closeMobileMenu() {
			document.getElementById('mobileSidebar').classList.remove('active');
			document.getElementById('mobileMenuOverlay').classList.remove('active');
			document.body.style.overflow = 'auto';
		}

		function toggleDropdown(id) {
			const list = document.getElementById(id + '-list');
			// Close all other dropdowns first
			document.querySelectorAll('.custom-dropdown-list.open').forEach(el => {
				if (el.id !== id + '-list') el.classList.remove('open');
			});
			list.classList.toggle('open');
		}

		function openUrl(url, dropdownId) {
			window.open(url, '_blank');
			// Close dropdown and reset label
			document.getElementById(dropdownId + '-list').classList.remove('open');
		}

		// Close dropdowns when clicking outside
		document.addEventListener('click', function(e) {
			if (!e.target.closest('.custom-dropdown')) {
				document.querySelectorAll('.custom-dropdown-list.open').forEach(el => {
					el.classList.remove('open');
				});
			}
		});
    </script>
	
<!-- Add this before </body> tag -->
<div class="mobile-menu-overlay" id="mobileMenuOverlay" onclick="closeMobileMenu()"></div>
<div class="mobile-sidebar" id="mobileSidebar" dir="ltr">
    <div class="mobile-sidebar-header">
        <h3>Menu</h3>
        <button class="close-sidebar" onclick="closeMobileMenu()" style="font-size: 2rem;">&times;</button>
    </div>
    <div class="mobile-sidebar-content">
        <div class="mobile-tool-section">
            <h4><i class="fas fa-map"></i> War Maps</h4>
            <div class="custom-dropdown" id="warMapsDropdown">
				<button class="custom-dropdown-selected" onclick="toggleDropdown('warMapsDropdown')">
					<span>Select Map...</span>
					<i class="fas fa-chevron-down"></i>
				</button>
				<div class="custom-dropdown-list" id="warMapsDropdown-list">
					<div class="custom-dropdown-item disabled">Conflict maps</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.tzevaadom.co.il/', 'warMapsDropdown')">🚨 Tzofar - Tzeva Adom</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://hezbollah.liveuamap.com/', 'warMapsDropdown')">🔴 Hezbollah Map</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://lebanon.liveuamap.com/', 'warMapsDropdown')">🔴 Lebanon Map</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://israelpalestine.liveuamap.com/', 'warMapsDropdown')">🔴 Israel-Palestine Map</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.washingtoninstitute.org/hezbollahinteractivemap/', 'warMapsDropdown')">🔴 Lebanese Hezbollah</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://health.liveuamap.com/en/ukraine', 'warMapsDropdown')">🔴 Ukraine</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://isis.liveuamap.com/', 'warMapsDropdown')">🔴 ISIS Map</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://iran.liveuamap.com/', 'warMapsDropdown')">🔴 Iran Map</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">Military Deployment</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://experience.arcgis.com/experience/6893435f0297454a988ad2e6bf474a7b', 'warMapsDropdown')">🪖 Centcom - Middle East</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">Skies</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.flightradar24.com/34.00,36.33/7', 'warMapsDropdown')">✈️ Flight Radar 24</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.windy.com/?38.150,30.863,4,p:wind', 'warMapsDropdown')">🌨️ Windy</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.ventusky.com/#p=37.6;32.5;4', 'warMapsDropdown')">🌧️ Ventusky</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.mooncalc.org/#/51.5071,14.5886,3/2026.02.22/03:19/1/3', 'warMapsDropdown')">🌕 Moon Calculator</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://starwalk.space/en/moon-calendar', 'warMapsDropdown')">🌕 Starwalk Moon</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://satellitemap.space/', 'warMapsDropdown')">🛰️ StarLink</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">Sea</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.marinetraffic.com/en/ais/home/centerx:25.2/centery:36.7/zoom:6', 'warMapsDropdown')">🌊 Marine Traffic</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">Hazards</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://eq.gsi.gov.il/heb/earthquake/lastEarthquakes.php', 'warMapsDropdown')">🟤 Earthquakes</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://health.liveuamap.com/en/epidemics', 'warMapsDropdown')">🦠 Epidemics</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.gmcmap.com/', 'warMapsDropdown')">☢️ GMC Map</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://map.safecast.org/?y=32.19&x=44.76&z=7&l=0&m=0', 'warMapsDropdown')">☢️ SafeCast map</div>
				</div>
			</div>
        </div>
        <div class="mobile-tool-section">
            <h4><i class="fas fa-newspaper"></i> News Sites</h4>
            <div class="custom-dropdown" id="newsSitesDropdown">
				<button class="custom-dropdown-selected" onclick="toggleDropdown('newsSitesDropdown')">
					<span>Select News Site...</span>
					<i class="fas fa-chevron-down"></i>
				</button>
				<div class="custom-dropdown-list" id="newsSitesDropdown-list">
					<div class="custom-dropdown-item disabled">🇮🇱 Israeli</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.n12.co.il/', 'newsSitesDropdown')">N12</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.0404.co.il/', 'newsSitesDropdown')">0404</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.jpost.com/', 'newsSitesDropdown')">Jerusalem Post</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.timesofisrael.com/', 'newsSitesDropdown')">Times of Israel</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.zman.co.il/', 'newsSitesDropdown')">Zman Israel</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://rotter.net/', 'newsSitesDropdown')">Rotter</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.i24news.tv/en', 'newsSitesDropdown')">i24News</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.nziv.net/', 'newsSitesDropdown')">Nziv.net</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">🌍 Western</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://edition.cnn.com/', 'newsSitesDropdown')">CNN</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.nbcnews.com/', 'newsSitesDropdown')">NBC</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://apnews.com/', 'newsSitesDropdown')">AP News</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.nytimes.com/international/', 'newsSitesDropdown')">New York Times</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.bbc.com/', 'newsSitesDropdown')">BBC</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.reuters.com/', 'newsSitesDropdown')">Reuters</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.wsj.com/', 'newsSitesDropdown')">Wall Street Journal</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.washingtonpost.com/', 'newsSitesDropdown')">Washington Post</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.foxnews.com/', 'newsSitesDropdown')">Fox News</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.washingtoninstitute.org/', 'newsSitesDropdown')">Washington Institute</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">🇶🇦 Qatar</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.aljazeera.com/', 'newsSitesDropdown')">Al-Jazeera</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">🇸🇦 Saudi Arabia</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://english.almayadeen.net/', 'newsSitesDropdown')">Al-Mayadeen</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.alhadath.net/', 'newsSitesDropdown')">Al-Hadath</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">🇮🇷 Iran</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.alalam.ir/', 'newsSitesDropdown')">Al-Alam</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">☠️ Hezbollah</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://english.alarabiya.net/', 'newsSitesDropdown')">Al-Arabiya</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://english.almanar.com.lb/', 'newsSitesDropdown')">Al-Manar</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">🇺🇸 US-funded Arabic</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://www.alhurra.com/', 'newsSitesDropdown')">Al-Hurra</div>
					<div class="custom-dropdown-item separator"></div>
					<div class="custom-dropdown-item disabled">📈 Other</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://polymarket.com/', 'newsSitesDropdown')">PolyMarket</div>
					<div class="custom-dropdown-item" onclick="openUrl('https://usstrikeradar.com/', 'newsSitesDropdown')">Strike Radar</div>
				</div>
			</div>
        </div>
        <div class="mobile-tool-section">
            <h4><i class="fas fa-search"></i> Search Location</h4>
            <input type="text" class="mobile-search-input" id="mobileSearchBox" placeholder="Search location...">
        </div>
    </div>
</div>
	
</body>
</html>
